# 实现存储的统一接口

存储 是可替换系统 程序切换不同的存储系统 对代码的影响最好最小 或者零影响。

## 关于缩略图

缩略图采用动态生成机制 只生成指定尺寸图片 这些图片都是可以安全删除的  是可再生的！
在动态生成缩略图中 基本流程是这样的：

-   ngnix 或者apache根据url重定向规则 当小文件 不存在时 会把请求重定向到入口文件（一般是index.php 后端是admin.php 最好是
    写一个为前后端配置下就行了--前后端共享！）
    在urlManager规则中配置处理特殊模式图片路径的映射规则。
-   专门处理缩略图的action中 先获取原始的图片路径位置。然后利用正则解析 得到不同的缩略量，旋转量等参数。
    使用图形库 进行图片操作，然后回写到底层存储系统中去
-   把处理好的图片发送给浏览器，或者使用重定向，让浏览器再次请求生好的小图片。


不同的存储系统图片的原始格式不一样，所以为了支持这些系统，每个系统都可能有自己的缩略处理action urlRules规则
但上面的流程大致相同！
